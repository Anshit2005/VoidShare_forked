<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>File and Key Encryption</title>
  <link rel="stylesheet" href="ecc_style.css"/>
  <script type="module" src="ency_decy_module.js"></script>
  <script type="module" src="p2p.js"></script>
</head>

<body onload="initializeAES()">

  <!-- Header Section -->
  <header>
    <div class="header-container">
      <h1>Secure File and Key Encryption</h1>
      <p>Your privacy, our priority.</p>
    </div>
  </header>

  <div class="container">
    <h2>File and Key Encryption</h2>

    <!-- Display User Peer ID -->
    <h3>Your Peer ID</h3>
    <p id="peerIdDisplay">Not Connected to server</p>
    <button id="copyPeerIdBtn" onclick="copyPeerId()">Copy Peer ID</button>
    <p id="copyStatus" style="display:none;">Peer ID copied to clipboard!</p>

    <h3>Peer-to-Peer File Transfer</h3>
    <p>Share your Peer ID with a friend to connect.</p>
    <button onclick="connectToSignalingServer()">Connect to Signaling Server</button>

    <!-- Friend's Peer ID -->
    <h4>Enter Friend's Peer ID to Connect:</h4>
    <input type="text" id="peerIdInput" placeholder="Enter Peer ID" />
    <button onclick="requestPeerConnection()">Connect</button>
    <button onclick="disconnectPeer()">Disconnect</button>
    <p id="statusMessage" class="status-message"></p>

    <div id="customConfirm" class="modal" style="display:none;">
      <div class="modal-content">
        <p id="confirmMessage">Are you sure?</p>
        <div class="modal-buttons">
          <button id="confirmYesBtn">Yes</button>
          <button id="confirmNoBtn">No</button>
        </div>
      </div>
    </div>

    <p class="rejectionstatus"></p>

    <div id="encryptionSection" style="display: none;">
      <h3>Encrypt and Decrypt Files</h3>
      <input type="file" id="fileInput" class="file-input" />
      <button onclick="encryptFile()">Encrypt File</button>
      <a id="downloadLink" class="download-link" style="display:none;">Download File</a>
    </div>

    <button class="sendbtn" onclick="sendEncryptedFile()">Send Encrypted File</button>

    <div>
      <h4>Transfer Progress</h4>
      <label>Sender Progress</label>
      <progress id="senderProgressBar" value="0" max="100"></progress><br />

      <label>Receiver Progress</label>
      <progress id="receiverProgressBar" value="0" max="100"></progress><br />

      <a id="receiverDownloadLink" style="display: none;">Download Received File</a>

      <div class="file-receive">
        <h3>Decrypt and Download File</h3>
        <button onclick="decryptFile()">Decrypt File</button>
        <a id="downloadLinkdecy" class="download-link" style="display:none;">Download File</a>
      </div>
    </div>
  </div>

  <script src="ecc.js"></script>
  <script src="p2p.js"></script>

</body>
</html>
